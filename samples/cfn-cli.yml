# Configuration file version, mandatory. 
Version: 2

# Default values for all stacks in this configuration file, 
# can be overwritten in environment stacks.
#
# You can also specify shell environment variables using:
#   ${VARIABLE_NAME}
Blueprints:
  
  # Stack default configuration name
  DynamoDBSecondaryIndexes:

    # AWS CLI profile name.
    # Optional, use default profile if this is not specified
    Profile: default
    
    # AWS region name for the stack
    Region: us-east-1

    # Template file location, specify a local file using relative path,
    # or s3 location (recognized automatically).
    Template: https://s3-us-west-2.amazonaws.com/cloudformation-templates-us-west-2/DynamoDB_Secondary_Indexes.template

    # Canned stack policy, possible values are:
    #   - DENY_ALL : deny all modify/delete
    #   - DENY_DELETE: deny all delete
    #   - ALLOW_ALL: allow all updates
    #   - Local file: stack policy json file
    StackPolicy: DENY_ALL
    
    # XXX: policy s3 url, tbd...
#    StackPolicyURL:
    
    # List of stack capabilities, possible values are:
    #   - CAPABILITY_IAM: accesskeys, IAM user&groups, IAM roles&policy 
    #   - CAPABILITY_NAMED_IAM: IAM resources with custom names
    Capabilities: [CAPABILITY_IAM]
    
    # ARN of an IAM role that CloudFormation assumes when operating the stack.
    # If no value is specified, CloudFormatino uses a temporary session which 
    # generated form caller's credentials
#    RoleARN: 'arn:aws:iam::${AWS_ACCOUNT_ID}:role/StackRole'
    
    # A list of template resources which is allowed for stack creation:
    #   - AWS::* : all AWS resource
    #   - Custom:* : all custom resources
    #   - AWS::EC2::* : all resources of EC2 service
    #   - AWS::EC2::Instance : specific AWS resource
    # This value is used by IAM policy condition keys. 
    # By default, all resource types are allowed.
#    ResourceTypes:
    
    # List of SNS ARNs to publish stack related events.
#    NotificationARNs: ['arn:aws:sns::xxxxx']
    
    # XXX: new feature, tbd...
    # RollbackConfiguration:
    #  RollbackTriggers: [ '' ]
    #  MonitoringTimeInMinutes: 3
    
    # Automatically package local resources to s3. 
    #
    # These are supported automaticlly by aws cloudformation package command:
    #   - BodyS3Location property for the AWS::ApiGateway::RestApi resource
    #   - Code property for the AWS::Lambda::Function resource
    #   - CodeUri property for the AWS::Serverless::Function resource
    #   - DefinitionUri property for the AWS::Serverless::Api resource
    #   - SourceBundle  property for the AWS::ElasticBeanstalk::Application-Version resource
    #   - TemplateURL property for the AWS::CloudFormation::Stack resource
    #
    # XXX: need scan template file, TBD ~
    # These are implemented using Transform::Include:
    #   - DefinitionBody property for AWS::Serverless::Api resource
    #   - PolicyDocument property for IAM resources
    #   - DefinitionString property for AWS::StepFunctions::StateMachine resource
    #   - Sql property for IoT, Kinesis analytics and Glue resource
    Package:  false
    
    # S3 bucket name for packaging artifacts.
    # Default value is awscfncli-${AWS_ACCOUNT_ID}-${AWS_REGION}.
    # The bucket will be automaticlly created with default encryption enabled.
#    ArtifactStore:
    
    # Whether to enable termination protection on the stack, default is false.
    EnableTerminationProtection: false
    
    # Tags to associate with this stack
    Tags:
      Project:  Booba
      CostUnit: 1B0

    # Input parameters for the stack.
    Parameters:
      ReadCapacityUnits:      5
      WriteCapacityUnits:     5

Stages:

  # Stage name
  Default:
    
    # Stack name
    Table1:
      Extends: DynamoDBSecondaryIndexes

      # Overwride stack parameters
      Region: us-west-2

      Tags:
        Environment: staging
        
      Parameters:
        ReadCapacityUnits:      5

    Table2:
      Extends: DynamoDBSecondaryIndexes

      # Overwride stack parameters
      Region: us-west-2

      Tags:
        Environment: staging

      Parameters:
        ReadCapacityUnits:      5
